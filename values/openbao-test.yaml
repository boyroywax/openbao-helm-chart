# Values file for OpenBao Test Deployment
# Based on the Ollama model chart structure

# Release configuration
nameOverride: "openbao"
fullnameOverride: ""

# Labels to apply to all resources
labels:
  app: openbao
  component: vault

# Model/Service information (adapted from Ollama pattern)
model:
  name: "openbao-test"
  displayName: "OpenBao Vault Server"
  version: "latest"

# Namespace configuration
namespace:
  name: openbao-test
  create: true

# Global values that will be passed to subcharts
global:
  namespace:
    name: openbao-test

# DNS configuration for ingress
dns:
  subdomain: vault
  domain: layerwork.space

# OpenBao/Vault image configuration
image:
  repository: openbao/vault
  tag: latest
  pullPolicy: IfNotPresent

# Service Account configuration
serviceAccount:
  create: true
  name: ""
  annotations: {}

# OpenBao/Vault configuration
vault:
  config:
    ui: true
    listener:
      tcp:
        address: "0.0.0.0:8200"
        tls_disable: 1
    storage:
      file:
        path: "/vault/file"
  # Environment variables
  env:
    VAULT_DEV_ROOT_TOKEN_ID: "myroot"
    VAULT_DEV_LISTEN_ADDRESS: "0.0.0.0:8200"

# Service configuration
service:
  enabled: true
  type: ClusterIP
  port: 8200
  targetPort: 8200
  annotations: {}

# Ingress configuration
ingress:
  enabled: true
  className: "nginx"
  annotations:
    cert-manager.io/cluster-issuer: "letsencrypt-prod"
    nginx.ingress.kubernetes.io/ssl-redirect: "true"
  host: ""  # Will use dns.subdomain.dns.domain if not specified
  path: /
  pathType: ImplementationSpecific
  tls:
    enabled: true
    secretName: ""  # Auto-generated if not specified

# Persistence configuration for NFS
persistence:
  enabled: true
  storageClass: "do-block-storage"
  accessModes:
    - ReadWriteMany
  size: 10Gi

# Resource configuration
resources:
  limits:
    cpu: 1000m
    memory: 1Gi
  requests:
    cpu: 500m
    memory: 512Mi

# Node selector, tolerations, and affinity
nodeSelector: {}

tolerations: []

affinity: {}

# Security context
securityContext: {}

# Pod security context
podSecurityContext: {}

# NFS Server configuration (subchart)
nfs-server:
  enabled: true
  global:
    namespace:
      name: openbao-test
  # NFS server storage backend
  storage:
    enabled: true
    storageClass: "do-block-storage"
    size: 20Gi
    accessMode: ReadWriteOnce
  # NFS service configuration
  nfs:
    image:
      repository: k8s.gcr.io/volume-nfs
      tag: "0.8"
    service:
      enabled: true
      type: ClusterIP
      port: 2049
    # Export configuration
    exports:
      - path: "/nfsshare/data"
        options: "rw,sync,no_subtree_check,no_root_squash"
